<div class="container">
  <div class="results"><%= @rules.size %> normas encontradas</div>
  <table class="table">
    <thead class="thead-dark">
      <% if @rules.size.positive? %>
        <tr>
          <th scope="col">Jurisdição</th>
          <th scope="col">Emissor</th>
          <th scope="col">Categoria</th>
          <th scope="col">Número</th>
          <th scope="col">Data de Publicação</th>
          <th scope="col">Data de Edição</th>
          <th scope="col">Ementa</th>
          <th scope="col">Fonte</th>
          <th scope="col">Origem da Norma</th>
        </tr>
      </thead>
      <tbody>
      <% @rules.each do |rule| %>
        <tr>
          <td><%= link_to rule.jurisdiction, rule_path(rule) %></td>
          <td><%= link_to rule.issuer, rule_path(rule) %></td>
          <td><%= link_to rule.category, rule_path(rule) %></td>
          <td><%= link_to rule.number, rule_path(rule) %></td>
          <td><%= link_to rule.pub_date, rule_path(rule) %></td>
          <td><%= link_to rule.ed_date, rule_path(rule) %></td>
          <td><%= link_to rule.long_title.truncate_words(10), rule_path(rule) %></td>
          <td><%= link_to rule.source, rule_path(rule) %></td>
          <td><%= link_to rule.user.first_name, rule_path(rule) %></td>
        </tr>
      <% end %>
      <% else %>
        <p class="title">Não foram encontrados resultados para essa busca</p>
      <% end %>
      </tbody>
  </table>
</div>

<script src="//code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="//cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>

<script>
$(document).ready(function(){
    $('.table').DataTable({
        "language": {
              "lengthMenu": "Mostrando _MENU_ registros por página",
              "zeroRecords": "Nada encontrado",
              "info": "Mostrando página _PAGE_ de _PAGES_",
              "infoEmpty": "Nenhum registro disponível",
              "infoFiltered": "(filtrado de _MAX_ registros no total)",
              "sSearch" : "Filtrar",
              "oPaginate": {
                      "sFirst":    "Primeira",
                      "sPrevious": "Anterior",
                      "sNext":     "Próxima",
                      "sLast":     "Última"
                    }
          }
      });
});

$("tr[data-link]").click(function() {
  window.location = $(this).data("link")
})

</script>
